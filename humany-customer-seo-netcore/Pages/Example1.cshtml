@page "{*path}"
@model Example1Model
@inject ISeoService seoService
@{
    ViewData["Title"] = "No result";
    var widgetConfig = new WidgetConfiguration("seo-customer", "inline-v4", "v4", Request.RouteValues.GetValueOrDefault("page", "")?.ToString() ?? "");
    var seoPage = await seoService.Get(widgetConfig.Tenant, widgetConfig.Interface, WidgetConfiguration.GetPathInWidget(widgetConfig.BasePath, Request.Path));
    if (seoPage != null)
        ViewData["Title"] = seoPage.Headers.GetValueOrDefault("HumanyTitle", "N/A");
}
<h1>@ViewData["Title"]</h1>

<p></p>

@section Scripts
{
    <script>
        window.setTimeout(function () { //emulate slow loading so we can see SEO version
            var seoElement = document.getElementById('seo-preview');
            seoElement.style = 'display: none';

            var widgetElement = document.getElementById('actual-widget');
            widgetElement.style = '';

            (function (a, b, c, d, e, f, g) {
                for (var h, i = /[?&]{1}(humany[^=]*)=([^&#]*)/g; h = i.exec(a.location.search);)c += (-1 < c.indexOf("?") ? "&" : "?") + h[1] + "=" + h[2];
                f = b.createElement(e), f.async = !0, f.src = c, g = b.getElementsByTagName(e)[0], g.parentNode.insertBefore(f, g), a[d] = a[d] || {
                    _c: [],
                    configure: function () { a[d]._c.push(arguments) }
                }; var j = d.toLowerCase(); a[j] = a[j] || { _c: [], configure: function () { a[j]._c.push(arguments) } }
            })(window, document, "//@(widgetConfig.HumanyTenantDomain)/@widgetConfig.Implementation/embed.js", "Humany", "script");

            window.humany.configure((config) => { config({ type: '@@humany/inline-widget' }).routing({ mode: 'browser', basePath: '@widgetConfig.BasePath' }) });

        }, 1000);
    </script>
}

@section Head
{
    <link href="//@(widgetConfig.HumanyTenantDomain)/ClientLibraries/Supplementary/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
    @*<link rel="stylesheet" type="text/css" href="//@(widgetConfig.HumanyTenantDomain)/@widgetConfig.Implementation/widgets.css">*@
    @{
        if (!string.IsNullOrEmpty(seoPage?.CssHref))
        {
            <link rel="stylesheet" type="text/css" href="@seoPage?.CssHref" />
        }
        if (!string.IsNullOrEmpty(seoPage?.CssContent))
        {
            <style id="seo-style">
                @seoPage?.CssContent
            </style>
        }
    }
}

<div id="actual-widget" style="display: none">
    <a href="//@(widgetConfig.HumanyTenantDomain)/@(widgetConfig.Interface)">...</a>
</div>

<div id="seo-preview">
    <p>THIS IS SEO @(seoPage?.Error?.Code == null ? "" : "" + seoPage.Error.Code + ": " + seoPage.Error.Message)</p>
    @Html.Raw(seoPage?.Html)
</div>
